<!DOCTYPE html>
<html
    lang="en"
    xmlns:th="http://www.thymeleaf.org"
    xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{admin/index.html}"
>
    <head></head>

    <body>
        <section layout:fragment="main">
            <div class="displayNotifications"></div>
            <main id="main" class="main">
                <div class="pagetitle">
                    <h1>Bán hàng</h1>
                    <nav>
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="index.html">Trang chủ</a></li>
                            <li class="breadcrumb-item active">Bán hàng tại quầy</li>
                        </ol>
                    </nav>
                </div>
                <!-- End Page Title -->

                <section class="section dashboard">
                    <div class="col-lg-12 col-md-12">
                        <div class="card">
                            <div class="card-body">
                                <div class="container mt-4">
                                    <div class="d-flex justify-content-between">
                                        <h2>Sản phẩm</h2>
                                        <div>
                                            <button class="btn btn-outline-warning">QUÉT QR SẢN PHẨM</button>
                                            <button
                                                class="btn btn-outline-warning"
                                                data-bs-toggle="modal"
                                                data-bs-target="#addProductModal"
                                            >
                                                Thêm sản phẩm
                                            </button>
                                        </div>
                                    </div>
                                    <hr class="" />
                                    <div class="table-responsive">
                                        <table class="table table-group-divider text-center">
                                            <thead>
                                                <tr>
                                                    <th scope="col">Ảnh</th>
                                                    <th scope="col">Tên sản phẩm</th>
                                                    <th scope="col">Màu</th>
                                                    <th scope="col">Size</th>
                                                    <th scope="col">Giá</th>
                                                    <th scope="col">Số lượng</th>
                                                    <th scope="col">Thành tiền</th>
                                                    <th scope="col"></th>
                                                </tr>
                                            </thead>
                                            <tbody class="dssp">
                                                <tr
                                                    th:each="orderDetail,iterStat : ${orderDetails}"
                                                    class="align-middle"
                                                >
                                                    <td scope="row" class="position-relative">
                                                        <img
                                                            th:src="@{'/admin/img/'+${orderDetail.productVariant.product.image}}"
                                                            alt=""
                                                            class="img-fluid rounded-circle object-cover w-100 h-100"
                                                        />
                                                        <span
                                                            class="badge bg-success badge-custom position-absolute top-0 right-0"
                                                            th:if="${orderDetail.productVariant.product.discount}"
                                                        >
                                                            [[${#numbers.formatDecimal(orderDetail.productVariant.product.discount.discountPercent,0,'POINT',0,'COMMA')}]]
                                                            %
                                                        </span>
                                                    </td>
                                                    <td>[[${orderDetail.productVariant.product.name}]]</td>
                                                    <td>[[${orderDetail.productVariant.color.colorName}]]</td>
                                                    <td>[[${orderDetail.productVariant.size.sizeName}]]</td>
                                                    <td>
                                                        <span
                                                            th:unless="${orderDetail.productVariant.product.discount}"
                                                        >
                                                            [[${orderDetailFormattedPrices[iterStat.index]['oldPrice']}]]
                                                        </span>
                                                        <span
                                                            th:if="${orderDetail.productVariant.product.discount}"
                                                            class="text-decoration-line-through d-block"
                                                        >
                                                            [[${orderDetailFormattedPrices[iterStat.index]['oldPrice']}]]
                                                        </span>
                                                        <span
                                                            th:if="${orderDetail.productVariant.product.discount}"
                                                            class="text-danger fw-bold"
                                                        >
                                                            [[${orderDetailFormattedPrices[iterStat.index]['discountedPrice']}]]
                                                        </span>
                                                    </td>
                                                    <td>[[${orderDetail.quantity}]]</td>
                                                    <td class="text-danger fw-bold">
                                                        <span th:if="${orderDetail.productVariant.product.discount}">
                                                            [[${orderDetailFormattedPrices[iterStat.index]['discountIntoMoney']}]]
                                                        </span>
                                                        <span
                                                            th:unless="${orderDetail.productVariant.product.discount}"
                                                        >
                                                            [[${orderDetailFormattedPrices[iterStat.index]['intoMoney']}]]
                                                        </span>
                                                    </td>
                                                    <td class="text-end">
                                                        <button class="btn btn-outline-danger btn-sm">Xóa</button>
                                                    </td>
                                                </tr>
                                            </tbody>
                                            <tfoot>
                                                <tr>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td></td>
                                                    <td class="fw-bold text-black">Tổng tiền:</td>
                                                    <td class="text-danger fw-bold">[[${totalSum}]]</td>
                                                    <td></td>
                                                </tr>
                                            </tfoot>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </main>
            <!-- End #main -->
        </section>
    </body>
</html>
<!-- modal thêm sản phẩm -->
<div
    class="modal fade"
    id="addProductModal"
    tabindex="-1"
    data-bs-backdrop="static"
    data-bs-keyboard="false"
    role="dialog"
    aria-labelledby="modalTitleId"
    aria-hidden="true"
>
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-xl" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="modalTitleId">Tìm kiếm sản phẩm</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="d-flex justify-content-between">
                    <div>
                        <form th:action="@{/admin/orders/search}" method="get">
                            <div class="position-relative w-100">
                                <button
                                    type="submit"
                                    class="position-absolute end-0 top-50 translate-middle-y pe-3 text-warning fw-bold border-0 bg-transparent"
                                >
                                    <i class="bi bi-search"></i>
                                </button>
                                <input
                                    name="value"
                                    class="form-control ps-3"
                                    placeholder="Tìm theo tên sản phẩm,mã và thuộc tính sản phẩm..."
                                    style="width: 500px"
                                />
                            </div>
                        </form>
                    </div>
                    <div>Lọc theo giá</div>
                </div>
                <div class="d-flex align-items-center">
                    <h5>Danh mục</h5>
                    <h5>Màu sắc</h5>
                    <h5>Kích cỡ</h5>
                </div>
                <div class="table-reponsive">
                    <table class="table table-group-divider text-center">
                        <thead>
                            <tr>
                                <th scope="col">Mã</th>
                                <th scope="col">Ảnh</th>
                                <th scope="col">Tên sản phẩm</th>
                                <th scope="col">Danh mục</th>
                                <th scope="col">Màu</th>
                                <th scope="col">Size</th>
                                <th scope="col">Giá</th>
                                <th scope="col">Số lượng hàng</th>
                                <th scope="col"></th>
                            </tr>
                        </thead>
                        <tbody class="dssp">
                            <tr th:each="productVariant,iterStat : ${productVariants}" class="align-middle">
                                <td>[[${productVariant.productVariantId}]]</td>
                                <td scope="row" class="position-relative">
                                    <img
                                        th:src="@{'/admin/img/'+${productVariant.product.image}}"
                                        alt=""
                                        class="img-fluid rounded-circle object-cover w-100 h-100"
                                    />
                                    <span
                                        class="badge bg-success badge-custom position-absolute top-0 right-0"
                                        th:if="${productVariant.product.discount}"
                                    >
                                        [[${#numbers.formatDecimal(productVariant.product.discount.discountPercent,0,'POINT',0,'COMMA')}]]
                                        %
                                    </span>
                                </td>
                                <td>[[${productVariant.product.name}]]</td>
                                <td>[[${productVariant.product.category.name}]]</td>
                                <td>[[${productVariant.color.colorName}]]</td>
                                <td>[[${productVariant.size.sizeName}]]</td>
                                <td>
                                    <span th:unless="${productVariant.product.discount}">
                                        [[${productVariantFormatedPrices[iterStat.index]['oldPrice']}]]
                                    </span>
                                    <span
                                        th:if="${productVariant.product.discount}"
                                        class="text-decoration-line-through d-block"
                                    >
                                        [[${productVariantFormatedPrices[iterStat.index]['oldPrice']}]]
                                    </span>
                                    <span th:if="${productVariant.product.discount}" class="text-danger fw-bold">
                                        [[${productVariantFormatedPrices[iterStat.index]['discountedPrice']}]]
                                    </span>
                                </td>
                                <td>[[${productVariant.quantity}]]</td>
                                <td class="text-end">
                                    <button
                                        class="btn btn-outline-danger btn-sm"
                                        data-bs-toggle="modal"
                                        data-bs-target="#selectProductModal"
                                        id="openChildModal"
                                    >
                                        Chọn
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- modal chọn sản phẩm -->
<div
    class="modal fade"
    id="selectProductModal"
    tabindex="-1"
    data-bs-backdrop="static"
    data-bs-keyboard="false"
    role="dialog"
    aria-labelledby="modalTitleId"
    aria-hidden="true"
>
    <div class="modal-dialog modal-dialog-scrollable modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <form action="" method="post">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitleId1">Modal title</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">Body</div>
                <div class="modal-footer">
                    <button
                        type="button"
                        class="btn btn-primary"
                        data-bs-target="#addProductModal"
                        data-bs-toggle="modal"
                    >
                        Xác nhận
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
